# Software Architecture
Software sources are organized in the following classes types:
+ DAO: Data access objects. Classes that manage single tables of DB
+ DTO: Data transfer objects. Classes that contain data of each single table
+ QSQLiteManager: main class to manage database access
+ JsonCVECheckReportManager: main class to manage Json report generated by CVECheck tool
+ MdiSubWindow: Subwindow of report imported with Json the let filtering and analysis of report information
+ DialogImportCVEReport: Dialog to import CVE report and NVD DB inside application DB
+ MdiPDFReport: Subwindow of report exportable in PDF format
+ ReportData: Class that manage generation of HTML report shown inside MdiPDFReport window and generation of report in PDF format
+ DialogImportCVEDB: Dialog to import an update of NVD DB
+ MdiCVEData: Subwindow of CVE information of NVD CVE DB by NIST
+ QCVECheckApp: Main class of application
+ Main: Main application

## DAO/DTO Design Pattern
DAO/DTO Design Pattern let management of database tables splitting classes that contains data of a single row of a table by classes that are used to create, read, update, delete and list information of each table.

Main class of DTO classes is AbstractDTO which contains all basic definitions of  keys and virtual methods of hierarchy of classes.
Any other DTO class is derived by AbstractDTO and implements all methods used to read and write all fields of corresponding table of DB

### AbstractDTO
It's the base class of all DTO classes and and it's an abstract class that is implemented by all its derived classes.
It declares the class Key which is used as ID for each tuple of table of DB.
The appropriate ID is defined inside each derived class of class Key.

### CVEReportDTO
It's a derived class of AbstractDTO and is used to exchange data with CVEReport table of DB. Each instance of this class is a tuple of CVEReport table.
CVEReportKey is the unique identifier of CVEReport table tuple.

### PackageDTO
It's a derived class of AbstractDTO and is used to exchange data with Packages table of DB. Each instance of this class is a tuple of Packages table.
PackageKey is the unique identifier of Packages table tuple.

### ProductDTO
It's a derived class of AbstractDTO and is used to exchange data with Products table of DB. Each instance of this class is a tuple of Products table.
ProductKey is the unique identifier of Products table tuple.

### PackageProductDTO
It's a derived class of AbstractDTO and is used to exchange data with PackageProducts table of DB. Each instance of this class is a tuple of PackageProducts table. PackageProductKey is the unique identifier of PackageProducts table tuple.

### IssueDTO
It's a derived class of AbstractDTO and is used to exchange data with Issues table of DB. Each instance of this class is a tuple of Issues table.
IssueKey is the unique identifier of Issues table tuple.

### NVDDTO
It's a derived class of AbstractDTO and is used to exchange data with NVD table of DB. Each instance of this class is a tuple of NVD table.
NVDKey is the unique identifier of NVDs table tuple.

### AbstractDAO
It's the base class of all DAO classes and and it's an abstract class that is  implemented by all its derived classes.
It declares all virtual method used to manipulate data in the derived classes.
Defined abstract methods are:
* createDTO: create a tuple in the table
* readDTO: read a tuple from table
* updateDTO: update a tuple in the table
* deleteDTO: delete a tuple in the table

### CVEReportDAO
It's a derived class of AbstractDAO and implements all its abstract methods to manage data of CVEReport table.
And it define also other auxiliary methods:
* isNewReport: Verify whether the report has been already imported
* getCVEReportsList: it retrieves the list of all imported reports
* getFullCVEReport: it gets the whole CVEReport by its name with all it's information

### PackageDAO
It's a derived class of AbstractDAO implements all its abstract methods to manage data of Packages table.
And it define also other auxiliary methods:
* getPackagesOfReport: it retrieves packages associated to a specific CVEReport

### ProductDAO
It's a derived class of AbstractDAO implements all its abstract methods to manage data of Products table.
And it defines also other auxiliary methods:
* versionComparator: it compares the versions of Products and return which one is greater than the other
* getAllProducts: it gets all products by Products table
* getAllProductsNames: it gets all products names by Products table
* existsDTO: it verifies whether a product tuple is already present in the table
* getProducts: it gets all products affected by a specific CVE

### PackageProductDAO
It's a derived class of AbstractDAO implements all its abstract methods to manage data of PackageProduct table.
And it defines also other auxiliary methods:
* getPackageProducts: it retrieves all products associated to a package

### IssueDAO
It's a derived class of AbstractDAO implements all its abstract methods to manage data of Issues table.
And it defines also other auxiliary methods:
* getIssues: it retrieves all issues associated to a package

### NVDDAO
It's a derived class of AbstractDAO implements all its abstract methods to manage data of NVD table.
And it defines also other auxiliary methods:
* getAllNVDs: it retrieves all NVDs
* getNVD: it retrieves NVD associated to a specific issue

### QSQLiteManager
QSQLiteManager class manages accesses to DB and it orchestrates data exchanges with DB using DAO and DTO classes.
It manages connections, and defines following methods:
* openConnection: it opens the connection with database
* closeConnection: it closes the connection with database
* isNewReport: it verifies whether the json report has been already imported
* importJson: it imports the json report file inside the database
* importCVEDb: it imports the NVD DB by NIST inside the database
* getCVEReportsList: it gets the list of all CVEReports
* getFullCVEReport: it retrieves the full CVE report
* getPackagesModel: it gets the Packages model to show inside Packages view of CVE report window
* getCVEsModel: it gets the CVEs model to show inside CVE view of CVE report window
* getIgnoredCVEsModel: it gets the ignored CVE model to show inside Ignored CVE view of CVE report window
* getNVDDataProductsModel: it gets the Products model to show inside Products view of Search CVEs window
* getNVDDataNVDsModel: it gets the NVD model to show inside NVDs view of Search CVEs window
* getPackagesRowCount: it returns the total number of packages after that all filters have been applied in the CVE Report window
* getCVEsRowCount: it returns the total number of CVEs after that all filters have been applied of report in the CVE Report window
* getIgnoredCVEsRowCount: it returns the total number of Ignored CVE after that all filters have been applied in the CVE Report window
* getNVDDataNVDsRowCount: it returns the total number of NVDs after that all filters have been applied in the Search CVEs window
* getNVDDataProductsRowCount: it gets all Products after that all filters have been applied in the Search CVEs window
* getAllProductsNames: it returns the full list of all products names
* getPackagesRecords: it returns packages to show inside the Packages view of CVE Report window after that all filters have been applied
* getCVEsRecords: it returns CVEs to show inside the CVEs view of CVE Report window after that all filters have been applied
* getIgnoredCVEsRecords: it returns Ignored CVEs to show inside the Ignored CVEs view of CVE Report window after that all filters have been applied
* getPackagesQueryString: it returns the used by getPackagesRecords and setPackagesModelQuery methods
* getCVEsQueryString: it returns the used by getCVEsRecords and setCVEsmodelQuery methods
* getIgnoredCVEsQueryString: it returns the used by getIgnoredCVEsRecords and setIgnoredCVEsModelQuery methods

and following slots:
* setPackagesModelQuery: it sets packages model used to show them inside Packages view of CVE Report window after that all filters have been applied
* setCVEsModelQuery: it sets CVEs model used to show them inside CVES view of CVE Report window after that all filters have been applied
* setIgnoredCVEsModelQuery: it sets Ignored CVEs model used to show them inside Ignored CVEs view of CVE Report window after that all filters have been applied
* setNVDDataNVDsModelQuery: it sets Ignored CVEs model used to show them inside Ignored CVEs view of Search CVEs window after that all filters have been applied
* setNVDDataProductsModelQuery: it sets Products model used to show them inside Products view of Search CVEs window after that all filters have been applied

## JsonCVECheckReportManager
This class checks validity of Json CVE Check Report file. 
It has following methods:
* Open: it opens json file
* isValidCVEReport: it checks validity of Json CVE report file

## MdiSubWindow
This is the MDI window that shows CVE Report information.
It has following public methods:
* MdiSubWindow: Constructor of class that loads the report inside its view tables and set all controls of window
* LoadReportData: Method used to load and reload data of MdiSubWindow controls
* scrollToGroupBox: Method used to scroll current CVEReport window to corresponding section
* packagesKeysComparison: Method compares packages keys sort all of them properly
* setComboBoxCVEPackages: Method sets ComboBox of CVE Packages of CVE Report window

Protected methods:
* resizeEvent: Override of resizeEvent of QMdiSubWindow base class.
* resizePackagesTableView: Method manages resize of Packages Table View
* resizeCVEsTableView: Method manages resize of CVEs Table View
* resizeIgnoredCVEsTableView: Method manages resize of Ignored CVEs Table View
* resizeAllTables: Method calls resizePackagesTableView, resizeCVEsTableView and  resizeIgnoredCVEsTableView
* executeSelectPackages: Method launch thread that loads Packages data inside Packages view
* executeSelectCVEs: Method launch thread that loads CVEs data inside CVEs view
* executeSelectIgnoredCVEs: Method launch thread that loads Ignored CVEs data inside Ignored CVEs view

Protected slots:
* selectPackages: Method that runs inside thread that loads Packages data
* selectCVEs: Method that runs inside thread that loads CVEs data
* selectIgnoredCVEs: Method that runs inside thread that loads Ignored CVE data
* refreshPackagesTableView: Refreshes packages information and reloads model of Packages Table View
* refreshCVEsTableView: Refreshes CVEs information and reloads model of CVEs Table View
* refreshIgnoredCVEsTableView: Refreshes Ignored CVEs information and reloads model of Ignored CVEs Table View
* cvesTableViewClicked: Opens CVE web page of clicked CVE link
* ignoredCVEsTableViewClicked: Opens CVE web page of clicked Ignored CVE link
* executeSelectPackagesFinished: Refreshes view of Packages table
* executeSelectCVEsFinished: Refreshes view of CVEs table
* executeSelectIgnoredCVEsFinished: Refreshes view of Ignored CVE table

Private slots:
* on_checkBoxOnlyUnfixedPackages_stateChanged: Refresh Packages view after check/uncheck of Only Unfixed checkbox
* on_comboBoxShowPackages_currentIndexChanged: Refresh Packages view after selection of package inside combo box
* on_pushButtonSearchPackages_clicked: Refresh Packages view after push of package search button
* on_spinBoxPackagesPage_valueChanged: Refresh Packages view after change of value of page selection spin box
* on_pushButtonClearSearchPackages_clicked: Refresh Packages view after push of clear package search button
* on_comboBoxCVEsPackages_currentIndexChanged: Refresh Packages view after selection of package inside combo box
* on_comboBoxCVEsStatus_currentIndexChanged: Refresh CVEs view after selection of CVEs Status inside combo box
* on_comboBoxCVEsAttackVector_currentIndexChanged: Refresh CVEs view after selection of CVEs Attack Vector inside combo box
* on_comboBoxCVEsMinimumCVSS_currentIndexChanged: Refresh CVEs view after selection of CVEs Minimum CVSS inside combo box
* on_comboBoxShowCVEs_currentIndexChanged: Refresh CVEs view after selection of  Show CVE inside combo box
* on_pushButtonSearchCVEs_clicked: Refresh CVEs view after pushing of search CVEs button
* on_pushButtonClearSearchCVEs_clicked: Refresh CVEs view after pushing of clear search CVEs button3
* on_spinBoxCVEsPage_valueChanged: Refresh CVEs view after change of value of page selection spin box
* on_comboBoxShowIgnoredCVEs_currentIndexChanged: Refresh Ignored CVEs view after selection of CVE inside combo box
* on_pushButtonSearchIgnoredCVEs_clicked: Refresh Ignored CVEs view after pushing of search Ignored CVEs button
* on_pushButtonClearSearchIgnoredCVEe_clicked: Refresh Ignored CVEs view after pushing of clear search Ignored CVEs button
* on_spinBoxIgnoredCVEsPage_valueChanged: Refresh Ignored CVEs view after change of value of page selection spin box

Signals:
* packagesTableViewDataUpdated: Signal that triggers refreshPackagesTableView
* cvesTableViewDataUpdated: Signal that triggers refreshCVEsTableView
* ignoredCVEsTableViewDataUpdated: Signal that triggers refreshIgnoredCVEsTableView

## DialogImportCVEReport
This is the dialog window that is used to choose Json CVE Report file and NVD DB to import. It has following public methods:
* on_pushButtonOpenJsonFileName_clicked: Open the File Open Dialog Box to select the Json file to import.
* on_pushButtonOpenCVEDbFileName_clicked: Open the File Open Dialog Box to select the NVD DB file to import
* accept: Close the Dialog Box and start importing of Json and NVD DB file

## MdiPDFReport
This is the Mdi Window that let show information of report imported with Json file and NVD DB and let filter and analyze them.

It has following public methods:
* MdiPDFReport: Constructor of class that loads json file and calls LoadReportData method
* LoadReportData: Load information inside Mdi Window tables view and controls.

Private slots:
* ReportLoaded: Shows the MessageBox that communicate ends of importing of Json report
* ReportPrinted: Open dialog window that let saving of PDF report.

Private methods:
* PrintReport: Prints the report in PDF format
* PDFModifyFooterContext: Modify the footer of generated report using PDF-Writer library to manipulate it
* randomString: Generate a random string used to write a temporary PDF report in the tmp folder

Protected methods:
* resizeEvent: Override of resizeEvent method that manage the resize of window

## ReportData
This class loads the full CVE Report, calculate the summary and loads packages model, CVEs model and ignored CVE Model

Public methods:
* ReportData: Constructor of class that LoadReportData
* getFullCVEReport: Return the reference to fullCVEReport
* getSummary: Return the reference to summary
* getPackages: Return the reference to packages
* getCVEs: Return the reference to CVEs
* getIgnoredCVEs: Return the reference to Ignored CVEs
* selectPackagesRowCount: Return the number of rows of Packages
* selectCVEsRowCount: Return the number of rows of CVEs
* selectIgnoredCVEsRowCount: Return the number of rows of Ignored CVEs
* GenerateHtmlReport: Generate the HTML report
* getHtmlReport: Return reference to HTML report

Public slots:
* selectPackages: Set packages model to Packages table view
* selectCVEs: Set CVEs model to CVEs table view
* selectIgnoredCVEs: Set Ignored CVEs model to Ignored CVEs table view

Private methods:
* LoadReportData: Loads report information from database
* CalculateSummary: Calculate the summary of report
* setStyleSheet: Set the stylesheet of report
* getHtmlHeader: Returns the HMTL header in string format
* getHtmlBody: Returns the HMTL body in string format
* getHtmlReportGeneralInformation: Returns the HMTL general information in string format
* getHtmlReportSummary: Returns the HMTL report summary information in string format
* getHtmlReportPackages: Returns the HMTL report packages information in string format
* getHtmlReportUnpatchedCriticalCVEs: Returns the HMTL report unpatched critical  CVEs information in string format
* getHtmlReportUnpatchedHighCVEs: Returns the HMTL report unpatched high CVEs   information in string format
* getHtmlReportUnpatchedMediumCVEs: Returns the HMTL report unpatched medium CVEs information in string format
* getHtmlReportUnpatchedLowCVEs: Returns the HMTL report unpatched low CVEs information in string format
* getHtmlReportUnpatchedNoneCVEs: Returns the HMTL report unpatched none CVEs information in string format
* getHtmlReportIgnoredCVEs: Returns the HMTL report ignored CVEs information in string format

## DialogImportCVEDB
This is the dialog window that is used to choose NVD DB to update. It has following public methods:
* on_pushButtonOpenCVEDbFileName_clicked: Open the File Open Dialog Box to select the NVD DB file to import
* accept: Close the Dialog Box and start importing NVD DB file to use to update local DB

## MdiCVEData
This is the Mdi Window that let show information of NVD DB imported and let filter and analyze CVEs information.

Public methods:
* MdiCVEData: Constructor of class that loads data inside tables view and controls of Search CVEs window
* reloadData: Reloads data inside Products combo box and tables views
* scrollToGroupBox: Scrolls window view to NVD group box or Packages group box

Protected methods:
* productsKeysComparison: Compares products keys to sort products
* resizeEvent: Resizes controls of window 
* resizeNVDsTableView: Resizes NVDs table view
* resizeProductsTableView: Resizes Products table view
* setComboBoxNVDsProducts: Sets combo box of NVDs products
* executeSelectNVDs: Launches the thread that retrieves NVDs information
* selectNVDs: Retrieves NVDs after application of all filters
* executeSelectProducts: Launches the thread that retrieves products information
* selectProducts: Retrieves products after application of all filters

Signal:
* nvdsTableViewDataUpdated: Signal that triggers refreshNVDsTableView
* productsTableViewDataUpdated: Signal that triggers refreshProductsTableView

Protected slots:
* refreshNVDsTableView: Refreshes NVDs table view
* refreshProductsTableView: Refreshes Products table view
* nvdsTableViewClicked: Loads products information to corresponding NVD selected
* executeSelectNVDsFinished: Reloads NVDs table view and resize NVDs table
* executeSelectProductsFinished: Reloads Products table view and resize Products table

Private slots:
* on_comboBoxNVDsAttackVector_currentIndexChanged: 
* on_comboBoxNVDsMinimumCVSS_currentIndexChanged: 
* on_comboBoxShowNs_currentIndexChanged: 
* on_pushButtonSearchNVDs_clicked: 
* on_pushButtonClearSearchNVDs_clicked: 
* on_spinBoxNVDsPage_valueChanged: 
* on_comboBoxShowProducts_currentIndexChanged: 
* on_pushButtonSearchProducts_clicked: 
* on_pushButtonClearSearchProducts_clicked: 
* on_spinBoxProductsPage_valueChanged: 
* on_comboBoxNVDsProducts_currentIndexChanged: 

## QCVECheckApp
This is the main application class that manages controls of application interface. 

Public methods:
* QCVECheckApp: Setup the UI and loads already imported json report name in the CVE Report Combo Box
* resizeEvent: Resizes the controls of window the it sizes changes
* UpdateCVEReportsComboBox: Update CVE report combo box content

Signals:
* importJsonCVEReportFinished: Signal triggers slot jsonCVEReportImported
* importCVEDBFinished: Signal triggers slot CVEDBImported

Private slots:
* on_action_Open_triggered: Opens the dialog box that let choice of Json report file and NVD DB associated
* on_action_Exit_triggered: Exits by application
* on_comboBoxReports_currentIndexChanged: Opens the selected json report in the mdiSubWindow 
* on_pushButtonOpen_clicked: Open selected json report already selected in the comboBoxReport control in the mdiSubWindow
* on_pushButtonGeneral_clicked: Scrolls mdiMainWindow of report already selected in the comboBoxReport control to General section
* on_pushButtonSummary_clicked: Scrolls mdiMainWindow of report already selected in the comboBoxReport control to Summary section
* on_pushButtonPackages_clicked: Scrolls mdiMainWindow of report already selected in the comboBoxReport control to Packages section
* on_pushButtonCVEs_clicked: Scrolls mdiMainWindow of report already selected in the comboBoxReport control to CVEs section
* on_pushButtonIgnoredCVEs_clicked: Scrolls mdiMainWindow of report already selected in the comboBoxReport control to Ignored CVEs section
* on_actionImport_CVE_DB_triggered: Opens the dialog box that let choice of NVD DB to update local DB
* on_pushButtonCVEData_clicked: Open Search CVEs mdiCVEData window
* on_pushButtonExportReport_clicked: Open HTML report inside mdiPDFReport window and open Save Dialog Window of PDF file
* importCVEReport: Import json report file and NVD DB, triggers  importJsonCVEReportFinished and open informative dialog that show the message that import is finished succesfully or not
* importCVEDB: Import new NVD DB and updates information in the local DB
* jsonCVEReportImported: Updates cveReportComboBox and open mdiSubWindow of Json report file just imported, reloads all information of all other mdiSubWindow of json reports already opened.
* CVEDBImported: Reloads mdiCVEData window and all json CVE reports mdiSubWindow already opened
* UpdateCVEReportsComboBox: Updates CVE Report combo box control with list of all json report already imported

Private methods:
* OpenCVEReportWindow: Shows mdiSubWindow of json report name passed as parameter
* OpenPDFReportWindow: Shows pdfReportWindow of json report name passed as parameter

Protected methods:
* resizeEvent: Overriden resizeEvent method of QMdiWindow that manages resize of all controls of main window of application

## Main
Main entry point of application. It manages signals of operating system and starts the application.
Function of module are:
* main: entry point of application
* ignoreUnixSignals: Sets signals to ignore
* catchUnixSignals: Sets signals to catch and ignore
